(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{923:function(e,t,r){"use strict";r.r(t);r(7),r(6),r(8),r(4),r(9),r(21),r(41),r(34),r(14),r(42),r(47),r(35);var n=r(1),c=r(0),o=r(30),l=(r(25),r(15),r(20),r(3),r(2),r(26),r(94),r(331),r(46),r(17)),f=r.n(l),d=r(5);function j(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,c=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw c}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function x(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?x(Object(source),!0).forEach((function(t){Object(c.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):x(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var m={data:function(){return{models:[{text:"เลือกประเภทการเรียนรู้ (Select training type)",value:null}].concat(Object(o.a)(this.$extensions.map((function(e){return{text:e.title,value:e.id}})))),selectType:null,projectList:[],projectToOpen:null,files:null,step:1,progress:0,percentage:0,serverFileLength:0}},created:function(){},computed:h(h({},Object(d.e)(["currentDevice","isSaving","isOpening","serverUrl"])),{},{projectState:function(){return"BROWSER"==this.currentDevice?(this.step>=3||1==this.step)&&this.files&&this.files.length>0:"ROBOT"==this.currentDevice?(this.step>=3||1==this.step)&&this.projectToOpen:void 0},projectByType:function(){var e=this,t=this.projectList.filter((function(t){return t.projectType==e.selectType}));return t.length>0?t.map((function(e){return{text:e.name,value:e.id}})):(this.projectToOpen=null,null)}}),methods:h(h(h(h({},Object(d.d)("project",["setProject"])),Object(d.b)("dataset",["addFileToFs","clearDataset","restoreDataset"])),Object(d.b)("project",["fetchProjects"])),{},{clearForm:function(){this.selectType=null,this.projectToOpen=null,this.projectList=[],this.files=[],this.serverFileLength=0,this.step=1,this.progress=0},fetchProject:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("ROBOT"!=e.currentDevice){t.next=4;break}return t.next=3,e.fetchProjects();case 3:e.projectList=t.sent;case 4:case"end":return t.stop()}}),t)})))()},getServerFile:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.a.get("".concat(t.serverUrl,"/projects/").concat(t.projectToOpen,"/raw_dataset/").concat(e),{responseType:"blob"});case 2:return n=r.sent,r.abrupt("return",new File([n.data],e));case 4:case"end":return r.stop()}}),r)})))()},getServerProjectFile:function(e){var t=arguments,r=this;return Object(n.a)(regeneratorRuntime.mark((function n(){var c,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=t.length>1&&void 0!==t[1]?t[1]:"blob",n.next=3,f.a.get("".concat(r.serverUrl,"/projects/").concat(r.projectToOpen,"/").concat(e),{responseType:c});case 3:if(o=n.sent,"blob"!=c){n.next=6;break}return n.abrupt("return",new File([o.data],e));case 6:return n.abrupt("return",o.data);case 7:case"end":return n.stop()}}),n)})))()},openProjectHandle:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n,c,o,l,d,v,x,h,m,O,k,y,F,T,w,S,_,P,D,data,R,I,B,C,E,L,A,$,U,W,M,J;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("BROWSER"!=t.currentDevice){r.next=88;break}if(1!=t.step){r.next=85;break}if(e.preventDefault(),t.step=2,t.progress=0,n=t.files.find((function(e){return"project.json"==e.name}))){r.next=10;break}return t.step=1,t.$toast.error("Folder ที่เลือกไม่พบโปรเจคไฟล์"),r.abrupt("return",!1);case 10:return c=t.files.filter((function(e){return e.name!=n.name})),r.next=13,t.$helper.readFile(n);case 13:return o=r.sent,l=JSON.parse(o),d=l.project.project.id,r.next=18,t.clearDataset();case 18:console.log("cleared"),v=j(c),r.prev=20,v.s();case 22:if((x=v.n()).done){r.next=30;break}return h=x.value,t.progress+=1,t.percentage=Math.round(t.progress/c.length*100)-5,r.next=28,t.addFileToFs({projectId:d,file:h});case 28:r.next=22;break;case 30:r.next=35;break;case 32:r.prev=32,r.t0=r.catch(20),v.e(r.t0);case 35:return r.prev=35,v.f(),r.finish(35);case 38:if(!(m=t.files.find((function(e){return"model.json"==e.name})))){r.next=61;break}return r.next=42,t.addFileToFs({projectId:d,file:m});case 42:O=j(t.files.filter((function(e){return e.name.endsWith(".bin")}))),r.prev=43,O.s();case 45:if((k=O.n()).done){r.next=51;break}return y=k.value,r.next=49,t.addFileToFs({projectId:d,file:y});case 49:r.next=45;break;case 51:r.next=56;break;case 53:r.prev=53,r.t1=r.catch(43),O.e(r.t1);case 56:return r.prev=56,O.f(),r.finish(56);case 59:r.next=62;break;case 61:l.project.project.tfjs="";case 62:if(t.percentage=96,!(F=t.files.find((function(e){return"model_edgetpu.tflite"==e.name})))){r.next=69;break}return r.next=67,t.addFileToFs({projectId:d,file:F});case 67:r.next=70;break;case 69:l.project.project.edgetpu="";case 70:if(t.percentage=98,!t.files.find((function(e){return"labels.txt"==e.name}))){r.next=77;break}return r.next=75,t.addFileToFs({projectId:d,file:F});case 75:r.next=78;break;case 77:l.project.project.labelFile="";case 78:t.percentage=99,t.restoreDataset(l.dataset.dataset),t.setProject(l.project.project),t.step=3,t.$toast.success("เปิดโปรเจคและนำเข้าเสร็จเรียบร้อย"),r.next=86;break;case 85:t.step;case 86:r.next=212;break;case 88:if("ROBOT"!=t.currentDevice){r.next=212;break}if(1!=t.step){r.next=211;break}return e.preventDefault(),t.step=2,t.progress=0,r.next=95,f.a.get("".concat(t.serverUrl,"/projects/").concat(t.projectToOpen,"/project.json"));case 95:if(!(T=r.sent)||200==T.status){r.next=100;break}return t.step=1,t.$toast.error("ไม่พบโปรเจคไฟล์"),r.abrupt("return",!1);case 100:return w=T.data,S=w.project.project.id,r.next=104,t.clearDataset();case 104:console.log("cleared"),_=w.dataset.dataset.data,t.serverFileLength=_.length,P=j(_),r.prev=108,P.s();case 110:if((D=P.n()).done){r.next=139;break}if(data=D.value,t.progress+=1,t.percentage=Math.round(t.progress/_.length*100),"VOICE_CLASSIFICATION"!=w.project.project.projectType){r.next=132;break}return r.next=117,t.getServerFile("".concat(data.id,".").concat(data.ext));case 117:return R=r.sent,r.next=120,t.addFileToFs({projectId:S,file:R});case 120:return r.next=122,t.getServerFile("".concat(data.id,"_mfcc.jpg"));case 122:return I=r.sent,r.next=125,t.addFileToFs({projectId:S,file:I});case 125:return r.next=127,t.getServerFile("".concat(data.id,".").concat(data.sound_ext));case 127:return B=r.sent,r.next=130,t.addFileToFs({projectId:S,file:B});case 130:r.next=137;break;case 132:return r.next=134,t.getServerFile("".concat(data.id,".").concat(data.ext));case 134:return C=r.sent,r.next=137,t.addFileToFs({projectId:S,file:C});case 137:r.next=110;break;case 139:r.next=144;break;case 141:r.prev=141,r.t2=r.catch(108),P.e(r.t2);case 144:return r.prev=144,P.f(),r.finish(144);case 147:return r.prev=147,r.next=150,t.getServerProjectFile("labels.txt");case 150:return E=r.sent,r.next=153,t.addFileToFs({projectId:S,file:E});case 153:r.next=157;break;case 155:r.prev=155,r.t3=r.catch(147);case 157:return r.prev=157,r.next=160,t.getServerProjectFile("model_edgetpu.tflite");case 160:return L=r.sent,r.next=163,t.addFileToFs({projectId:S,file:L});case 163:r.next=167;break;case 165:r.prev=165,r.t4=r.catch(157);case 167:return r.prev=167,r.next=170,t.getServerProjectFile("model.json");case 170:return A=r.sent,r.next=173,t.addFileToFs({projectId:S,file:A});case 173:r.next=177;break;case 175:r.prev=175,r.t5=r.catch(167);case 177:return r.prev=177,r.next=180,t.getServerProjectFile("model.json","text");case 180:$=r.sent,U=j($.weightsManifest[0].paths),r.prev=182,U.s();case 184:if((W=U.n()).done){r.next=193;break}return M=W.value,r.next=188,t.getServerProjectFile(M);case 188:return J=r.sent,r.next=191,t.addFileToFs({projectId:S,file:J});case 191:r.next=184;break;case 193:r.next=198;break;case 195:r.prev=195,r.t6=r.catch(182),U.e(r.t6);case 198:return r.prev=198,U.f(),r.finish(198);case 201:r.next=205;break;case 203:r.prev=203,r.t7=r.catch(177);case 205:t.restoreDataset(w.dataset.dataset),t.setProject(w.project.project),t.step=3,t.$toast.success("เปิดโปรเจคและนำเข้าเสร็จเรียบร้อย"),r.next=212;break;case 211:t.step;case 212:case"end":return r.stop()}}),r,null,[[20,32,35,38],[43,53,56,59],[108,141,144,147],[147,155],[157,165],[167,175],[177,203],[182,195,198,201]])})))()},delay:function(time){return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){setTimeout((function(){e()}),time)})));case 1:case"end":return e.stop()}}),e)})))()}})},O=m,k=r(11),component=Object(k.a)(O,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-modal",{attrs:{id:"open-project-modal",title:"เปิดโปรเจค","ok-disabled":!e.projectState},on:{show:e.fetchProject,hidden:e.clearForm,ok:e.openProjectHandle}},["ROBOT"==e.currentDevice?r("div",[r("form",{on:{submit:function(e){e.stopPropagation(),e.preventDefault()}}},[r("b-form-group",{attrs:{label:"Project type"}},[r("b-form-select",{attrs:{id:"project-type",options:e.models,required:""},model:{value:e.selectType,callback:function(t){e.selectType=t},expression:"selectType"}})],1)],1),e._v(" "),r("p",{staticClass:"p-notice-color small"},[e._v("* เลือกโปรเจคที่ต้องการเปิด")]),e._v(" "),e.projectByType?r("b-form-select",{attrs:{id:"project-id",options:e.projectByType,required:""},model:{value:e.projectToOpen,callback:function(t){e.projectToOpen=t},expression:"projectToOpen"}}):e._e()],1):"BROWSER"==e.currentDevice&&1==e.step?r("div",[r("b-row",{staticClass:"mb-4"},[r("b-col",[r("b-form-file",{attrs:{placeholder:"เลือกโฟลเดอร์ของโปรเจค","drop-placeholder":"ลากโฟลเดอร์ของโปรเจคมาวางที่นี่...",multiple:"",directory:""},model:{value:e.files,callback:function(t){e.files=t},expression:"files"}})],1)],1),e._v(" "),r("p",{staticClass:"p-notice-color small"},[e._v("* เลือกโฟลเดอร์ของโปรเจคที่ต้องการเปิด")])],1):e._e(),e._v(" "),e.step>=2?r("div",{staticClass:"text-center"},[r("vm-progress",{staticStyle:{"vertical-align":"middle"},attrs:{type:"circle",percentage:e.percentage,strokeColor:"#007E4E","stroke-width":"24",width:200}},[2==e.step&&"BROWSER"==e.currentDevice?r("h4",{staticClass:"my-3",attrs:{"text-black":""}},[e._v("\n        กำลังนำเข้า ... "+e._s(e.progress)+"/"+e._s(e.files.length||"")+"\n      ")]):e._e(),e._v(" "),2==e.step&&"ROBOT"==e.currentDevice?r("h4",{staticClass:"my-3",attrs:{"text-black":""}},[e._v("\n        กำลังนำเข้า ... "+e._s(e.progress)+"/"+e._s(e.serverFileLength)+"\n      ")]):3==e.step?r("h4",{staticClass:"my-3",attrs:{"text-black":""}},[e._v("นำเข้าสำเร็จ")]):e._e()])],1):e._e()])}),[],!1,null,null,null);t.default=component.exports}}]);